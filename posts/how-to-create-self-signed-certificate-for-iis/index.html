<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>How to Create a Self-Signed Certificate for IIS and Host a Website | Book of Daniel</title>
<meta name=keywords content="ssl,posh"><meta name=description content="Create a self-signed certificate for your development site."><meta name=author content="Dan"><link rel=canonical href=https://bookofdaniel.in/posts/how-to-create-self-signed-certificate-for-iis/><meta name=google-site-verification content="G-VXV565Z72E"><link crossorigin=anonymous href=/assets/css/stylesheet.f4293b8f53210bcabd910256bfd1bad549ca35946bf52a51c2e8d0bbc7e42cc8.css integrity="sha256-9Ck7j1MhC8q9kQJWv9G61UnKNZRr9SpRwujQu8fkLMg=" rel="preload stylesheet" as=style><link rel=icon href=https://bookofdaniel.in/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=16x16 href=https://bookofdaniel.in/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=32x32 href=https://bookofdaniel.in/%3Clink%20/%20abs%20url%3E><link rel=apple-touch-icon href=https://bookofdaniel.in/%3Clink%20/%20abs%20url%3E><link rel=mask-icon href=https://bookofdaniel.in/%3Clink%20/%20abs%20url%3E><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://bookofdaniel.in/posts/how-to-create-self-signed-certificate-for-iis/><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><link rel=preconnect href=https://fonts.googleapis.com><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link href=https://fonts.cdnfonts.com/css/code-new-roman rel=stylesheet><link href="https://fonts.googleapis.com/css2?family=Source+Code+Pro:wght@400;700&display=swap" rel=stylesheet><script async src="https://www.googletagmanager.com/gtag/js?id=G-VXV565Z72E"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-VXV565Z72E")}</script><meta property="og:title" content="How to Create a Self-Signed Certificate for IIS and Host a Website"><meta property="og:description" content="Create a self-signed certificate for your development site."><meta property="og:type" content="article"><meta property="og:url" content="https://bookofdaniel.in/posts/how-to-create-self-signed-certificate-for-iis/"><meta property="og:image" content="https://bookofdaniel.in/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta property="article:section" content="posts"><meta property="article:published_time" content="2024-09-19T16:03:25+05:30"><meta property="article:modified_time" content="2024-09-19T16:03:25+05:30"><meta property="og:site_name" content="Book of Daniel"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://bookofdaniel.in/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:title content="How to Create a Self-Signed Certificate for IIS and Host a Website"><meta name=twitter:description content="Create a self-signed certificate for your development site."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://bookofdaniel.in/posts/"},{"@type":"ListItem","position":2,"name":"How to Create a Self-Signed Certificate for IIS and Host a Website","item":"https://bookofdaniel.in/posts/how-to-create-self-signed-certificate-for-iis/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"How to Create a Self-Signed Certificate for IIS and Host a Website","name":"How to Create a Self-Signed Certificate for IIS and Host a Website","description":"Create a self-signed certificate for your development site.","keywords":["ssl","posh"],"articleBody":"A few weeks ago, I got a task from my manager that seemed straightforward at first: set up a development environment for one of our upcoming projects. The catch? It needed to be accessible over HTTPS, just like our production sites. Now, getting a certificate from a trusted Certificate Authority (CA) for a development environment didn’t make much sense, and we certainly didn’t want to incur extra costs or deal with the complexities of a CA for something internal.\nSo, I figured I’d go the route of creating a self-signed certificate. This way, we could get our development site up and running with HTTPS quickly and securely, without any unnecessary overhead. After a bit of tinkering and some PowerShell magic, I had everything set up. And since it worked so well, I thought I’d share the process with you.\nHere’s how you can create a self-signed certificate for IIS and host a website on your development environment, using a simple PowerShell script.\nThe Script Let’s dive into the script that makes all this possible:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 param( [Parameter(Mandatory=$true)] [string]$DomainName, [Parameter(Mandatory=$true)] [string]$WebsiteName ) # Import the WebAdministration module to work with IIS Import-Module WebAdministration # Generate a new self-signed certificate $cert = New-SelfSignedCertificate -DnsName $DomainName -CertStoreLocation \"cert:\\LocalMachine\\My\" # Export the certificate's thumbprint $certThumbprint = $cert.Thumbprint # Get the site object in IIS $site = Get-Item \"IIS:\\Sites\\$WebsiteName\" # Remove existing HTTPS bindings (if any) $bindings = $site.Bindings.Collection | Where-Object { $_.protocol -eq \"https\" } foreach ($binding in $bindings) { Remove-WebBinding -Name $WebsiteName -BindingInformation $binding.bindingInformation -Protocol https } # Create a new HTTPS binding New-WebBinding -Name $WebsiteName -IPAddress \"*\" -Port 443 -HostHeader $DomainName -Protocol https # Assign the certificate to the new binding $binding = Get-WebBinding -Name $WebsiteName -Protocol https -Port 443 $binding.AddSslCertificate($certThumbprint, \"My\") Write-Host \"Self-signed certificate created and bound to site '$WebsiteName' with domain '$DomainName'.\" Step-by-Step Breakdown Parameter Setup: The script starts by asking for two mandatory parameters: the domain name (DomainName) and the website name (WebsiteName). These parameters will guide the rest of the script.\nLoad the WebAdministration Module: This module is necessary to interact with IIS through PowerShell. It’s what allows us to create and manage sites, bindings, and other IIS configurations.\nCreate a Self-Signed Certificate: Using the New-SelfSignedCertificate cmdlet, the script generates a self-signed certificate for the specified domain. The certificate is stored in the local machine’s “My” certificate store.\nRetrieve the Certificate Thumbprint: The thumbprint is a unique identifier for the certificate, which is necessary to link it to the site’s binding.\nGet the IIS Site Object: The script uses Get-Item to grab the IIS site object for the specified website. This allows us to work directly with the site’s properties, including its bindings.\nRemove Existing HTTPS Bindings: Before adding a new HTTPS binding, any existing ones are removed to ensure there are no conflicts or duplicate bindings.\nCreate a New HTTPS Binding: The script sets up a new HTTPS binding on port 443, using the provided domain name.\nBind the Certificate: Finally, the script attaches the self-signed certificate to the HTTPS binding using its thumbprint, ensuring that the site is now accessible via HTTPS.\nConfirmation: After everything is done, the script outputs a confirmation message to let you know the certificate was successfully created and bound to the website.\nAvoiding Browser Warnings Due to the Self-Signed Certificate When using a self-signed certificate, most browsers will display a warning because the certificate isn’t issued by a trusted Certificate Authority (CA). To avoid these warnings, you can import the certificate into your browser’s trusted root certificate store. Here’s how you can do that in major browsers:\nHow to Import a Self-Signed Certificate into Your Browser 1. Google Chrome Windows/macOS: Open Chrome and go to chrome://settings. Scroll down and click on “Advanced” to expand more settings. Under “Privacy and security,” click on “Manage certificates” (or “Security” \u003e “Manage certificates” on macOS). In the “Certificates” window, click on the “Trusted Root Certification Authorities” tab. Click “Import” and follow the wizard to import the self-signed certificate. Once imported, restart Chrome, and the browser should no longer show a warning for sites using this certificate. 2. Mozilla Firefox Windows/macOS/Linux: Open Firefox and go to about:preferences. Scroll down to “Privacy \u0026 Security.” Under the “Certificates” section, click on “View Certificates.” In the “Certificate Manager” window, go to the “Authorities” tab. Click on “Import” and select the self-signed certificate file. Choose “Trust this CA to identify websites” and click “OK.” The certificate is now trusted by Firefox. 3. Microsoft Edge (Chromium-based) Windows/macOS: Open Edge and go to edge://settings. Scroll down and click on “Advanced settings.” Click on “Manage certificates” under “Privacy and services.” In the “Certificates” window, go to the “Trusted Root Certification Authorities” tab. Click “Import” and follow the wizard to import the certificate. Restart Edge, and the warning should disappear for sites using the self-signed certificate. 4. Safari (macOS) Double-click the self-signed certificate file (.cer or .crt) to open it in Keychain Access. In the Keychain Access window, locate the certificate, which will be listed under the “Certificates” category. Double-click on the certificate, and a new window will open. Expand the “Trust” section. Change “When using this certificate” to “Always Trust.” Close the window and enter your macOS password to confirm the change. Safari will now trust the certificate, and you won’t see any warnings when visiting the site. 5. Internet Explorer Windows: Open Internet Explorer and go to Internet Options. Go to the “Content” tab and click on “Certificates.” Go to the “Trusted Root Certification Authorities” tab and click “Import.” Follow the wizard to import the self-signed certificate. Once imported, restart Internet Explorer. Wrapping Up Setting up HTTPS for a development environment doesn’t have to be complicated or expensive. By creating a self-signed certificate, you can quickly secure your site and make sure it mirrors your production environment as closely as possible. Whether you’re preparing for a presentation or just want to ensure everything is configured correctly before going live, this PowerShell script has you covered.\nSo, next time your manager asks you to spin up a development environment with HTTPS, you’ll know exactly what to do! 😊\n","wordCount":"1048","inLanguage":"en","image":"https://bookofdaniel.in/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E","datePublished":"2024-09-19T16:03:25+05:30","dateModified":"2024-09-19T16:03:25+05:30","author":[{"@type":"Person","name":"Dan"}],"mainEntityOfPage":{"@type":"WebPage","@id":"https://bookofdaniel.in/posts/how-to-create-self-signed-certificate-for-iis/"},"publisher":{"@type":"Organization","name":"Book of Daniel","logo":{"@type":"ImageObject","url":"https://bookofdaniel.in/%3Clink%20/%20abs%20url%3E"}}}</script></head><body class=dark id=top><script>localStorage.getItem("pref-theme")==="light"&&document.body.classList.remove("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://bookofdaniel.in/ accesskey=h title="Book of Daniel (Alt + H)">Book of Daniel</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://bookofdaniel.in/posts/ title=Blog><span>Blog</span></a></li><li><a href=https://bookofdaniel.in/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://bookofdaniel.in/>Home</a>&nbsp;»&nbsp;<a href=https://bookofdaniel.in/posts/>Posts</a></div><h1 class="post-title entry-hint-parent">How to Create a Self-Signed Certificate for IIS and Host a Website</h1><div class=post-description>Create a self-signed certificate for your development site.</div><div class=post-meta><span title='2024-09-19 16:03:25 +0530 +0530'>September 19, 2024</span>&nbsp;·&nbsp;5 min&nbsp;·&nbsp;1048 words&nbsp;·&nbsp;Dan</div></header><aside id=toc-container class="toc-container wide"><div class=toc><details open><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#the-script aria-label="The Script">The Script</a></li><li><a href=#step-by-step-breakdown aria-label="Step-by-Step Breakdown">Step-by-Step Breakdown</a></li><li><a href=#avoiding-browser-warnings-due-to-the-self-signed-certificate aria-label="Avoiding Browser Warnings Due to the Self-Signed Certificate">Avoiding Browser Warnings Due to the Self-Signed Certificate</a><ul><li><a href=#how-to-import-a-self-signed-certificate-into-your-browser aria-label="How to Import a Self-Signed Certificate into Your Browser">How to Import a Self-Signed Certificate into Your Browser</a></li><li><a href=#1-google-chrome aria-label="1. Google Chrome"><strong>1. Google Chrome</strong></a></li><li><a href=#2-mozilla-firefox aria-label="2. Mozilla Firefox"><strong>2. Mozilla Firefox</strong></a></li><li><a href=#3-microsoft-edge-chromium-based aria-label="3. Microsoft Edge (Chromium-based)"><strong>3. Microsoft Edge (Chromium-based)</strong></a></li><li><a href=#4-safari-macos aria-label="4. Safari (macOS)"><strong>4. Safari (macOS)</strong></a></li><li><a href=#5-internet-explorer aria-label="5. Internet Explorer"><strong>5. Internet Explorer</strong></a></li></ul></li><li><a href=#wrapping-up aria-label="Wrapping Up">Wrapping Up</a></li></ul></div></details></div></aside><script>let activeElement,elements;window.addEventListener("DOMContentLoaded",function(){checkTocPosition(),elements=document.querySelectorAll("h1[id],h2[id],h3[id],h4[id],h5[id],h6[id]"),activeElement=elements[0];const t=encodeURI(activeElement.getAttribute("id")).toLowerCase();document.querySelector(`.inner ul li a[href="#${t}"]`).classList.add("active")},!1),window.addEventListener("resize",function(){checkTocPosition()},!1),window.addEventListener("scroll",()=>{activeElement=Array.from(elements).find(e=>{if(getOffsetTop(e)-window.pageYOffset>0&&getOffsetTop(e)-window.pageYOffset<window.innerHeight/2)return e})||activeElement,elements.forEach(e=>{const t=encodeURI(e.getAttribute("id")).toLowerCase();e===activeElement?document.querySelector(`.inner ul li a[href="#${t}"]`).classList.add("active"):document.querySelector(`.inner ul li a[href="#${t}"]`).classList.remove("active")})},!1);const main=parseInt(getComputedStyle(document.body).getPropertyValue("--article-width"),10),toc=parseInt(getComputedStyle(document.body).getPropertyValue("--toc-width"),10),gap=parseInt(getComputedStyle(document.body).getPropertyValue("--gap"),10);function checkTocPosition(){const e=document.body.scrollWidth;e-main-toc*2-gap*4>0?document.getElementById("toc-container").classList.add("wide"):document.getElementById("toc-container").classList.remove("wide")}function getOffsetTop(e){if(!e.getClientRects().length)return 0;let t=e.getBoundingClientRect(),n=e.ownerDocument.defaultView;return t.top+n.pageYOffset}</script><div class=post-content><p>A few weeks ago, I got a task from my manager that seemed straightforward at first: set up a development environment for one of our upcoming projects. The catch? It needed to be accessible over HTTPS, just like our production sites. Now, getting a certificate from a trusted Certificate Authority (CA) for a development environment didn’t make much sense, and we certainly didn’t want to incur extra costs or deal with the complexities of a CA for something internal.</p><p>So, I figured I’d go the route of creating a self-signed certificate. This way, we could get our development site up and running with HTTPS quickly and securely, without any unnecessary overhead. After a bit of tinkering and some PowerShell magic, I had everything set up. And since it worked so well, I thought I’d share the process with you.</p><p>Here’s how you can create a self-signed certificate for IIS and host a website on your development environment, using a simple PowerShell script.</p><h3 id=the-script>The Script<a hidden class=anchor aria-hidden=true href=#the-script>#</a></h3><p>Let&rsquo;s dive into the script that makes all this possible:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-powershell data-lang=powershell><span class=line><span class=cl><span class=k>param</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=p>[</span><span class=nb>Parameter</span><span class=p>(</span><span class=na>Mandatory</span><span class=p>=</span><span class=vm>$true</span><span class=p>)]</span>
</span></span><span class=line><span class=cl>    <span class=p>[</span><span class=no>string</span><span class=p>]</span><span class=nv>$DomainName</span><span class=p>,</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=p>[</span><span class=nb>Parameter</span><span class=p>(</span><span class=na>Mandatory</span><span class=p>=</span><span class=vm>$true</span><span class=p>)]</span>
</span></span><span class=line><span class=cl>    <span class=p>[</span><span class=no>string</span><span class=p>]</span><span class=nv>$WebsiteName</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c># Import the WebAdministration module to work with IIS</span>
</span></span><span class=line><span class=cl><span class=nb>Import-Module</span> <span class=n>WebAdministration</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c># Generate a new self-signed certificate</span>
</span></span><span class=line><span class=cl><span class=nv>$cert</span> <span class=p>=</span> <span class=nb>New-SelfSignedCertificate</span> <span class=n>-DnsName</span> <span class=nv>$DomainName</span> <span class=n>-CertStoreLocation</span> <span class=s2>&#34;cert:\LocalMachine\My&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c># Export the certificate&#39;s thumbprint</span>
</span></span><span class=line><span class=cl><span class=nv>$certThumbprint</span> <span class=p>=</span> <span class=nv>$cert</span><span class=p>.</span><span class=py>Thumbprint</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c># Get the site object in IIS</span>
</span></span><span class=line><span class=cl><span class=nv>$site</span> <span class=p>=</span> <span class=nb>Get-Item</span> <span class=s2>&#34;IIS:\Sites\</span><span class=nv>$WebsiteName</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c># Remove existing HTTPS bindings (if any)</span>
</span></span><span class=line><span class=cl><span class=nv>$bindings</span> <span class=p>=</span> <span class=nv>$site</span><span class=p>.</span><span class=py>Bindings</span><span class=p>.</span><span class=py>Collection</span> <span class=p>|</span> <span class=nb>Where-Object</span> <span class=p>{</span> <span class=nv>$_</span><span class=p>.</span><span class=py>protocol</span> <span class=o>-eq</span> <span class=s2>&#34;https&#34;</span> <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=k>foreach</span> <span class=p>(</span><span class=nv>$binding</span> <span class=k>in</span> <span class=nv>$bindings</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nb>Remove-WebBinding</span> <span class=n>-Name</span> <span class=nv>$WebsiteName</span> <span class=n>-BindingInformation</span> <span class=nv>$binding</span><span class=p>.</span><span class=py>bindingInformation</span> <span class=n>-Protocol</span> <span class=n>https</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c># Create a new HTTPS binding</span>
</span></span><span class=line><span class=cl><span class=nb>New-WebBinding</span> <span class=n>-Name</span> <span class=nv>$WebsiteName</span> <span class=n>-IPAddress</span> <span class=s2>&#34;*&#34;</span> <span class=n>-Port</span> <span class=mf>443</span> <span class=n>-HostHeader</span> <span class=nv>$DomainName</span> <span class=n>-Protocol</span> <span class=n>https</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c># Assign the certificate to the new binding</span>
</span></span><span class=line><span class=cl><span class=nv>$binding</span> <span class=p>=</span> <span class=nb>Get-WebBinding</span> <span class=n>-Name</span> <span class=nv>$WebsiteName</span> <span class=n>-Protocol</span> <span class=n>https</span> <span class=n>-Port</span> <span class=mf>443</span>
</span></span><span class=line><span class=cl><span class=nv>$binding</span><span class=p>.</span><span class=py>AddSslCertificate</span><span class=p>(</span><span class=nv>$certThumbprint</span><span class=p>,</span> <span class=s2>&#34;My&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>Write-Host</span> <span class=s2>&#34;Self-signed certificate created and bound to site &#39;</span><span class=nv>$WebsiteName</span><span class=s2>&#39; with domain &#39;</span><span class=nv>$DomainName</span><span class=s2>&#39;.&#34;</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=step-by-step-breakdown>Step-by-Step Breakdown<a hidden class=anchor aria-hidden=true href=#step-by-step-breakdown>#</a></h3><ol><li><p><strong>Parameter Setup</strong>: The script starts by asking for two mandatory parameters: the domain name (<code>DomainName</code>) and the website name (<code>WebsiteName</code>). These parameters will guide the rest of the script.</p></li><li><p><strong>Load the WebAdministration Module</strong>: This module is necessary to interact with IIS through PowerShell. It’s what allows us to create and manage sites, bindings, and other IIS configurations.</p></li><li><p><strong>Create a Self-Signed Certificate</strong>: Using the <code>New-SelfSignedCertificate</code> cmdlet, the script generates a self-signed certificate for the specified domain. The certificate is stored in the local machine&rsquo;s &ldquo;My&rdquo; certificate store.</p></li><li><p><strong>Retrieve the Certificate Thumbprint</strong>: The thumbprint is a unique identifier for the certificate, which is necessary to link it to the site’s binding.</p></li><li><p><strong>Get the IIS Site Object</strong>: The script uses <code>Get-Item</code> to grab the IIS site object for the specified website. This allows us to work directly with the site&rsquo;s properties, including its bindings.</p></li><li><p><strong>Remove Existing HTTPS Bindings</strong>: Before adding a new HTTPS binding, any existing ones are removed to ensure there are no conflicts or duplicate bindings.</p></li><li><p><strong>Create a New HTTPS Binding</strong>: The script sets up a new HTTPS binding on port 443, using the provided domain name.</p></li><li><p><strong>Bind the Certificate</strong>: Finally, the script attaches the self-signed certificate to the HTTPS binding using its thumbprint, ensuring that the site is now accessible via HTTPS.</p></li><li><p><strong>Confirmation</strong>: After everything is done, the script outputs a confirmation message to let you know the certificate was successfully created and bound to the website.</p></li></ol><h3 id=avoiding-browser-warnings-due-to-the-self-signed-certificate>Avoiding Browser Warnings Due to the Self-Signed Certificate<a hidden class=anchor aria-hidden=true href=#avoiding-browser-warnings-due-to-the-self-signed-certificate>#</a></h3><p>When using a self-signed certificate, most browsers will display a warning because the certificate isn’t issued by a trusted Certificate Authority (CA). To avoid these warnings, you can import the certificate into your browser&rsquo;s trusted root certificate store. Here’s how you can do that in major browsers:</p><h4 id=how-to-import-a-self-signed-certificate-into-your-browser>How to Import a Self-Signed Certificate into Your Browser<a hidden class=anchor aria-hidden=true href=#how-to-import-a-self-signed-certificate-into-your-browser>#</a></h4><h4 id=1-google-chrome><strong>1. Google Chrome</strong><a hidden class=anchor aria-hidden=true href=#1-google-chrome>#</a></h4><ul><li><strong>Windows/macOS:</strong><ol><li>Open Chrome and go to <code>chrome://settings</code>.</li><li>Scroll down and click on &ldquo;Advanced&rdquo; to expand more settings.</li><li>Under &ldquo;Privacy and security,&rdquo; click on &ldquo;Manage certificates&rdquo; (or &ldquo;Security&rdquo; > &ldquo;Manage certificates&rdquo; on macOS).</li><li>In the &ldquo;Certificates&rdquo; window, click on the &ldquo;Trusted Root Certification Authorities&rdquo; tab.</li><li>Click &ldquo;Import&rdquo; and follow the wizard to import the self-signed certificate.</li><li>Once imported, restart Chrome, and the browser should no longer show a warning for sites using this certificate.</li></ol></li></ul><h4 id=2-mozilla-firefox><strong>2. Mozilla Firefox</strong><a hidden class=anchor aria-hidden=true href=#2-mozilla-firefox>#</a></h4><ul><li><strong>Windows/macOS/Linux:</strong><ol><li>Open Firefox and go to <code>about:preferences</code>.</li><li>Scroll down to &ldquo;Privacy & Security.&rdquo;</li><li>Under the &ldquo;Certificates&rdquo; section, click on &ldquo;View Certificates.&rdquo;</li><li>In the &ldquo;Certificate Manager&rdquo; window, go to the &ldquo;Authorities&rdquo; tab.</li><li>Click on &ldquo;Import&rdquo; and select the self-signed certificate file.</li><li>Choose &ldquo;Trust this CA to identify websites&rdquo; and click &ldquo;OK.&rdquo;</li><li>The certificate is now trusted by Firefox.</li></ol></li></ul><h4 id=3-microsoft-edge-chromium-based><strong>3. Microsoft Edge (Chromium-based)</strong><a hidden class=anchor aria-hidden=true href=#3-microsoft-edge-chromium-based>#</a></h4><ul><li><strong>Windows/macOS:</strong><ol><li>Open Edge and go to <code>edge://settings</code>.</li><li>Scroll down and click on &ldquo;Advanced settings.&rdquo;</li><li>Click on &ldquo;Manage certificates&rdquo; under &ldquo;Privacy and services.&rdquo;</li><li>In the &ldquo;Certificates&rdquo; window, go to the &ldquo;Trusted Root Certification Authorities&rdquo; tab.</li><li>Click &ldquo;Import&rdquo; and follow the wizard to import the certificate.</li><li>Restart Edge, and the warning should disappear for sites using the self-signed certificate.</li></ol></li></ul><h4 id=4-safari-macos><strong>4. Safari (macOS)</strong><a hidden class=anchor aria-hidden=true href=#4-safari-macos>#</a></h4><ul><li><ol><li>Double-click the self-signed certificate file (.cer or .crt) to open it in Keychain Access.</li></ol></li><li><ol start=2><li>In the Keychain Access window, locate the certificate, which will be listed under the &ldquo;Certificates&rdquo; category.</li></ol></li><li><ol start=3><li>Double-click on the certificate, and a new window will open.</li></ol></li><li><ol start=4><li>Expand the &ldquo;Trust&rdquo; section.</li></ol></li><li><ol start=5><li>Change &ldquo;When using this certificate&rdquo; to &ldquo;Always Trust.&rdquo;</li></ol></li><li><ol start=6><li>Close the window and enter your macOS password to confirm the change.</li></ol></li><li><ol start=7><li>Safari will now trust the certificate, and you won’t see any warnings when visiting the site.</li></ol></li></ul><h4 id=5-internet-explorer><strong>5. Internet Explorer</strong><a hidden class=anchor aria-hidden=true href=#5-internet-explorer>#</a></h4><ul><li><strong>Windows:</strong><ol><li>Open Internet Explorer and go to <code>Internet Options</code>.</li><li>Go to the &ldquo;Content&rdquo; tab and click on &ldquo;Certificates.&rdquo;</li><li>Go to the &ldquo;Trusted Root Certification Authorities&rdquo; tab and click &ldquo;Import.&rdquo;</li><li>Follow the wizard to import the self-signed certificate.</li><li>Once imported, restart Internet Explorer.</li></ol></li></ul><h3 id=wrapping-up>Wrapping Up<a hidden class=anchor aria-hidden=true href=#wrapping-up>#</a></h3><p>Setting up HTTPS for a development environment doesn’t have to be complicated or expensive. By creating a self-signed certificate, you can quickly secure your site and make sure it mirrors your production environment as closely as possible. Whether you’re preparing for a presentation or just want to ensure everything is configured correctly before going live, this PowerShell script has you covered.</p><p>So, next time your manager asks you to spin up a development environment with HTTPS, you’ll know exactly what to do! 😊</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://bookofdaniel.in/tags/ssl/>Ssl</a></li><li><a href=https://bookofdaniel.in/tags/posh/>Posh</a></li></ul><nav class=paginav><a class=prev href=https://bookofdaniel.in/posts/kafka-explained-the-post-office-of-modern-data-streaming/><span class=title>« Prev</span><br><span>Kafka Explained: The Post Office of Modern Data Streaming</span>
</a><a class=next href=https://bookofdaniel.in/posts/why-yaml-and-how-to-ace-it/><span class=title>Next »</span><br><span>Why YAML and How to Ace It?</span></a></nav></footer><script src=https://giscus.app/client.js data-repo=dannotes/bookofdaniel-comments data-repo-id=R_kgDOMwnsUw data-category=Comments data-category-id=DIC_kwDOMwnsU84CiaCW data-mapping=pathname data-strict=0 data-reactions-enabled=1 data-emit-metadata=0 data-input-position=bottom data-theme=dark data-lang=en crossorigin=anonymous async></script></article></main><footer class=footer><span>&copy; 2024 <a href=https://bookofdaniel.in/>Book of Daniel</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>