<!DOCTYPE html>
<html><head>
<title>Issues Faced During WSFC Configuration for SQL Server AlwaysOn Setup</title>




<meta charset="utf-8">
<meta name="X-UA-Compatible" content="IE=edge">
<meta name="google-site-verification" content="">
<meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport">
<meta content="telephone=no" name="format-detection">
<meta name="description" content="">
<meta name="renderer" content="webkit">
<meta name="theme-color" content="#ffffff">















  






      <script src="/js/toc.js"></script>
    
    <link type="text/css" rel="stylesheet" href="/vendor/css/bootstrap.min.css">

<link rel="stylesheet" href="/scss/dark-mode.min.ff0aac816f46e60f7fa3eff2233a3a7afab2864b4571de3a7bad7adaba84c3cb.css" integrity="sha256-/wqsgW9G5g9/o&#43;/yIzo6evqyhktFcd46e6162rqEw8s=" media="screen">


<link rel="stylesheet"
          href="https://fonts.googleapis.com/css?family=Material+Icons">



















</head>
<body>
    	<div id="app"><div class="single-column-drawer-container" id="drawer"
     v-bind:class="{ 'single-column-drawer-container-active': isDrawerOpen }">
    <div class="drawer-content">
        <div class="drawer-menu">
            
            
            
                
                
                
                    
                
                
                
                <a class="a-block drawer-menu-item active" href="/posts">
                    Archives
                </a>
                
            
            
            <div class="toc">


	<div class="toc-content">
	
		
		
		
		<center>- CATALOG -</center>
		
		
		<ul>
			
				
				
					
						
						
						
						
							
								
									<ul>
								
							
						
						
							<li>
								<a href="#encountering-the-first-major-challenge-adding-a-cloud-witness" class="nav-encountering-the-first-major-challenge-adding-a-cloud-witness">
									Encountering the First Major Challenge: Adding a Cloud Witness
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
							
								
									<ul>
								
							
						
						
							<li>
								<a href="#navigating-through-the-storm" class="nav-navigating-through-the-storm">
									Navigating Through the Storm
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
							
								</ul>
							
						
						
						
							<li>
								<a href="#the-challenge-of-failover-resolution" class="nav-the-challenge-of-failover-resolution">
									The Challenge of Failover Resolution
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
							
								
									<ul>
								
							
						
						
							<li>
								<a href="#finding-a-path-forward" class="nav-finding-a-path-forward">
									Finding a Path Forward
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
							
								</ul>
							
						
						
						
							<li>
								<a href="#embracing-humility-and-the-joy-of-learning" class="nav-embracing-humility-and-the-joy-of-learning">
									Embracing Humility and the Joy of Learning
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#final-thoughts" class="nav-final-thoughts">
									Final Thoughts
								</a>
							</li>
						
						
					
				
			
		</ul>
	</div>

</div>
            
        </div>
    </div>
</div>
<transition name="fade">
    <div id="drawer-mask" v-bind:class="{ 'single-column-drawer-mask': mounted }" v-if="isDrawerOpen" v-on:click="toggleDrawer"></div>
</transition>
<nav id="navBar" class="navbar sticky-top navbar-light single-column-nav-container">
    <div id="navBackground" class="nav-background"></div>
    <div class="container container-narrow nav-content">
        <button id="nav_dropdown_btn" class="nav-dropdown-toggle" type="button" v-on:click="toggleDrawer">
            <i class="material-icons">
                menu
            </i>
        </button>
        <a id="navTitle" class="navbar-brand" href="https://bookofdaniel.in/">
            Book Of Daniel
        </a>
        
        <button type="button" class="nav-darkmode-toggle" id="darkModeToggleButton2">
            <i class="material-icons" id="darkModeToggleIcon2">
                dark_mode
            </i>
        </button>
        
    </div>
</nav>
<div class="single-column-header-container" id="pageHead"
     v-bind:style="{ transform: 'translateZ(0px) translateY('+.3*scrollY+'px)', opacity: 1-navOpacity }">
    <a href="https://bookofdaniel.in/">
        <div class="single-column-header-title">Book Of Daniel</div>
        

    </a>
</div>

            <div id="content">
                <div id="streamContainer" class="stream-container">

    <div class="post-list-container post-list-container-shadow">
        <div class="post">
            
            
            

            <div class="post-head-wrapper-text-only"
                
            >
                <div class="post-title">
                    Issues Faced During WSFC Configuration for SQL Server AlwaysOn Setup
                    
                    <div class="post-meta">
                        
                        <time itemprop="datePublished">
                            2024-03-01 22:58
                        </time>
                        

                        
                            <i class="material-icons" style="">folder</i>
                                <a href="/categories/notes">Notes</a>
                                &nbsp;
                        

                        
                        
                            <i class="material-icons" style="">schedule</i>
                            

                            
                            

                            
                            2 min
                            
                            57 s.
                        
                    </div>
                </div>
            </div>
            
            <div class="post-body-wrapper">
                
                <div class="post-body" v-pre>
                
                    <p>I&rsquo;ve had the privilege of navigating through a wide array of technical landscapes. Yet, the recent endeavor of configuring a Windows Server Failover Cluster (WSFC) for SQL Server AlwaysOn presented a learning curve that was both steep and enriching. In this piece, I hope to share my experiences, the challenges encountered, and the lessons learned, with a spirit of humility and the intention of contributing to our collective knowledge base.</p>
<h2 id="encountering-the-first-major-challenge-adding-a-cloud-witness">Encountering the First Major Challenge: Adding a Cloud Witness</h2>
<p>The journey began with an attempt to integrate a cloud witness into our WSFC configuration, a task that quickly unfolded into a series of troubleshooting steps. The primary node&rsquo;s refusal to fail over automatically, sticking instead in a &ldquo;resolving&rdquo; state, was our first major roadblock. The error message pointed towards an authentication and network recognition issue:</p>
<blockquote>
<p>&ldquo;An error was encountered while modifying the quorum settings. ERROR CODE: 0x80131500; NATIVE ERROR CODE: 1. WinRM cannot process the request&hellip; Cannot find the computer proddbcluster.test.com.&rdquo;</p>
</blockquote>
<h3 id="navigating-through-the-storm">Navigating Through the Storm</h3>
<p>The resolution required a combination of technical know-how and a willingness to delve deep into the problem. Here&rsquo;s how we approached it:</p>
<ol>
<li><strong>Step-by-Step Cloud Witness Configuration</strong>: I leaned on a comprehensive guide to configure a cloud witness via PowerShell, a testament to the importance of following detailed instructions meticulously <a href="https://www.jorgebernhardt.com/how-to-configure-a-cloud-witness-for-a-failover-cluster/">ðŸ”—</a>.</li>
<li><strong>Ensuring Secure Communications</strong>: Verifying SSL TLS 1.2 implementation was crucial, highlighting the necessity of adhering to secure communication protocols <a href="https://www.reddit.com/r/AZURE/comments/vtrl7x/comment/ifth3k4/?utm_source=share&amp;utm_medium=web3x&amp;utm_name=web3xcss&amp;utm_term=1&amp;utm_content=share_button">ðŸ”—</a>.</li>
<li><strong>Centralizing Control from the Owner Node</strong>: Initiating configuration changes from the owner node underscored the importance of a centralized command approach in managing cluster configurations effectively.</li>
<li><strong>Clearing the Slate</strong>: Prior to setting up anew, I used PowerShell scripts to clear any existing cloud witness configurations, ensuring we started from a clean slate <a href="https://www.reddit.com/r/AZURE/comments/vtrl7x/comment/jcfrpch/?utm_source=share&amp;utm_medium=web3x&amp;utm_name=web3xcss&amp;utm_term=1&amp;utm_content=share_button">ðŸ”—</a>.</li>
<li><strong>WinRM Configuration Check</strong>: The <code>winrm quickconfig</code> command was a crucial step in confirming the operational status of Windows Remote Management across all nodes, a critical component for remote management <a href="https://stackoverflow.com/questions/39917027/winrm-cannot-complete-the-operation-verify-that-the-specified-computer-name-is">ðŸ”—</a>.</li>
<li><strong>Testing Node-to-Storage Communication</strong>: It was essential to confirm that there were no communication barriers between the nodes and the cloud witness storage account, foundational for the health of the cluster.</li>
<li><strong>Utilizing Advanced Options for Cloud Witness Addition</strong>: During the cloud witness addition, selecting advanced options and ensuring all nodes were included was a critical step for a comprehensive setup <a href="https://blog.workinghardinit.work/2016/08/03/a-first-look-at-cloud-witness/">ðŸ”—</a>.</li>
<li><strong>Firewall Configuration Adjustments</strong>: Adjusting the firewall settings to facilitate WinRM communication and ensuring cloud witness storage accessibility from all networks were the breakthrough moments in this journey <a href="https://stackoverflow.com/a/60063137">ðŸ”—</a>.</li>
</ol>
<h2 id="the-challenge-of-failover-resolution">The Challenge of Failover Resolution</h2>
<p>Another significant challenge was the primary node&rsquo;s failure to automatically fail over to the secondary node during testing. This was an unexpected issue that required further investigation and adjustment.</p>
<h3 id="finding-a-path-forward">Finding a Path Forward</h3>
<p>The solution involved adjusting the Maximum Failover Period within the SQL Server configurations, a reminder of the importance of reviewing and fine-tuning these settings to accommodate our testing needs <a href="https://learn.microsoft.com/en-us/troubleshoot/sql/database-engine/availability-groups/troubleshooting-automatic-failover-problems#case-1-maximum-failures-in-the-specified-period-value-is-exhausted">ðŸ”—</a>.</p>
<h2 id="embracing-humility-and-the-joy-of-learning">Embracing Humility and the Joy of Learning</h2>
<p>This experience has been a humbling reminder that no matter the length of time one spends in the field, there&rsquo;s always more to learn. The challenges faced and the solutions found have reinforced a few core principles:</p>
<ul>
<li><strong>Precision Matters</strong>: The importance of attention to detail in every step of the configuration process cannot be overstated.</li>
<li><strong>Persistence Pays Off</strong>: Facing down errors and persisting through troubleshooting is part of the journey. Each challenge is an opportunity to learn.</li>
<li><strong>The Value of Community</strong>: The guidance and solutions shared by the broader community have been invaluable. It&rsquo;s a reminder of the strength found in collective knowledge.</li>
</ul>
<h2 id="final-thoughts">Final Thoughts</h2>
<p>The process of configuring WSFC for SQL Server AlwaysOn is a complex one, filled with potential pitfalls but also opportunities for growth and learning. My hope is that by sharing my journey, I can help others navigate similar challenges more smoothly. In the ever-evolving field of cloud and database architecture, each new project is a chance to expand our horizons and deepen our understanding.</p>

                    
                    <HR width="100%" id="EOF">
		    <p style="color:#777;">Last modified on 2024-03-01</p>
                    
                </div>
            </div>
            
            
            <nav class="post-pagination">

                
                <a class="newer-posts" href="/posts/how-programmers-can-become-10x-more-effective/">
			Next<br>How Programmers Can Become 10X More Effective by Applying the &#34;7 Habits of Highly Effective People&#34;
                </a>
                
                
                
                <a class="older-posts" href="/posts/the-batchology-handbook/">
			Previous<br>The Batchology Handbook: Mastering the Art of Batch Scripting in Windows
                </a>
                
            </nav>
            <div class="post-comment-wrapper">
                












            </div>
        </div>
    </div>


                    </div>
            </div><div id="sideContainer" class="side-container">
    
    <a class="a-block nav-head false" href="https://bookofdaniel.in/">
    
        <div class="nav-title">
            Book Of Daniel
        </div>
        
    </a>

    <div class="nav-link-list">
        
        
            
            
            
                
            
            
            
            <a class="a-block nav-link-item active" href="/posts">
                Archives
            </a>
            
        
    </div>

    

    <div class="nav-footer">
        
&copy;
	
	2024
	

    </div>
    
</div><div id="extraContainer" class="extra-container">
    <div class="toc-wrapper">
        

        
        <div class="toc">


	<div class="toc-content">
	
		
		
		
		<center>- CATALOG -</center>
		
		
		<ul>
			
				
				
					
						
						
						
						
							
								
									<ul>
								
							
						
						
							<li>
								<a href="#encountering-the-first-major-challenge-adding-a-cloud-witness" class="nav-encountering-the-first-major-challenge-adding-a-cloud-witness">
									Encountering the First Major Challenge: Adding a Cloud Witness
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
							
								
									<ul>
								
							
						
						
							<li>
								<a href="#navigating-through-the-storm" class="nav-navigating-through-the-storm">
									Navigating Through the Storm
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
							
								</ul>
							
						
						
						
							<li>
								<a href="#the-challenge-of-failover-resolution" class="nav-the-challenge-of-failover-resolution">
									The Challenge of Failover Resolution
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
							
								
									<ul>
								
							
						
						
							<li>
								<a href="#finding-a-path-forward" class="nav-finding-a-path-forward">
									Finding a Path Forward
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
							
								</ul>
							
						
						
						
							<li>
								<a href="#embracing-humility-and-the-joy-of-learning" class="nav-embracing-humility-and-the-joy-of-learning">
									Embracing Humility and the Joy of Learning
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#final-thoughts" class="nav-final-thoughts">
									Final Thoughts
								</a>
							</li>
						
						
					
				
			
		</ul>
	</div>

</div>
        
    </div>
    <div class="pagination">
        <a id="globalBackToTop" class="pagination-action animated-visibility" href="#top"
            :class="{ invisible: scrollY == 0 }">
            <i class="material-icons pagination-action-icon">
                keyboard_arrow_up
            </i>
        </a>
        
        <a type="button" class="pagination-action" id="darkModeToggleButton">
            <span class="material-icons pagination-action-icon" id="darkModeToggleIcon">
                dark_mode
            </span>
        </a>
        
        
    </div>
</div>

<div id="single-column-footer">
&copy;
	
	2024
	
</div>
            </div>
    
    <script src="/js/journal.js"></script></body>
</html>
